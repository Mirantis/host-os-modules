{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "cleanup_before": {
      "type": "boolean",
      "description": "whether to cleanup custom sysctl file if filename is provided"
    },
    "filename": {
      "type": "string",
      "pattern": "^[-a-zA-Z0-9_.]+$",
      "description": "custom file name to store sysctl settings in /etc/sysctl.d/ folder. The default is /etc/sysctl.conf"
    },
    "options": {
      "type": "object",
      "description": "sysctl options to be configured on host",
      "properties": {
        "fs.inotify.max_user_watches": {"type": "string", "const": "81920"},
        "kernel.core_pattern": {"type": "string", "const": "/dev/null"},
        "kernel.panic": {"type": "string", "const": "10"},
        "kernel.panic_on_oops": {"type": "string", "const": "1"},
        "kernel.keys.root_maxkeys": {"type": "string", "const": "1000000"},
        "kernel.keys.root_maxbytes": {"type": "string", "const": "25000000"},
        "kernel.pty.nr": {"type": "string", "const": "1"},
        "net.bridge.bridge-nf-call-arptables": {"type": "string", "const": "1"},
        "net.bridge.bridge-nf-call-ip6tables": {"type": "string", "const": "1"},
        "net.bridge.bridge-nf-call-iptables": {"type": "string", "const": "1"},
        "net.bridge.bridge-nf-filter-pppoe-tagged": {"type": "string", "const": "0"},
        "net.bridge.bridge-nf-filter-vlan-tagged": {"type": "string", "const": "0"},
        "net.bridge.bridge-nf-pass-vlan-input-dev": {"type": "string", "const": "0"},
        "net.fan.vxlan": {"type": "string", "const": "4"},
        "net.ipv4.conf.all.accept_redirects": {"type": "string", "const": "0"},
        "net.ipv4.conf.all.forwarding": {"type": "string", "const": "1"},
        "net.ipv4.conf.all.route_localnet": {"type": "string", "const": "1"},
        "net.ipv4.conf.default.forwarding": {"type": "string", "const": "1"},
        "net.ipv4.conf.lo.forwarding": {"type": "string", "const": "1"},
        "net.ipv4.ip_forward": {"type": "string", "const": "1"},
        "net.ipv4.ip_nonlocal_bind": {"type": "string", "const": "1"},
        "net.ipv4.vs.am_droprate": {"type": "string", "const": "10"},
        "net.ipv4.vs.amemthresh": {"type": "string", "const": "1024"},
        "net.ipv4.vs.backup_only": {"type": "string", "const": "0"},
        "net.ipv4.vs.cache_bypass": {"type": "string", "const": "0"},
        "net.ipv4.vs.conn_reuse_mode": {"type": "string", "const": "1"},
        "net.ipv4.vs.conntrack": {"type": "string", "const": "0"},
        "net.ipv4.vs.drop_entry": {"type": "string", "const": "0"},
        "net.ipv4.vs.drop_packet": {"type": "string", "const": "0"},
        "net.ipv4.vs.expire_nodest_conn": {"type": "string", "const": "0"},
        "net.ipv4.vs.ignore_tunneled": {"type": "string", "const": "0"},
        "net.ipv4.vs.nat_icmp_send": {"type": "string", "const": "0"},
        "net.ipv4.vs.pmtu_disc": {"type": "string", "const": "0"},
        "net.ipv4.vs.schedule_icmp": {"type": "string", "const": "0"},
        "net.ipv4.vs.secure_tcp": {"type": "string", "const": "0"},
        "net.ipv4.vs.sloppy_sctp": {"type": "string", "const": "0"},
        "net.ipv4.vs.sloppy_tcp": {"type": "string", "const": "0"},
        "net.ipv4.vs.snat_reroute": {"type": "string", "const": "1"},
        "net.ipv4.vs.sync_persist_mode": {"type": "string", "const": "0"},
        "net.ipv4.vs.sync_ports": {"type": "string", "const": "1"},
        "net.ipv4.vs.sync_refresh_period": {"type": "string", "const": "0"},
        "net.ipv4.vs.sync_retries": {"type": "string", "const": "0"},
        "net.ipv4.vs.sync_sock_size": {"type": "string", "const": "0"},
        "net.ipv4.vs.sync_threshold": {"type": "string", "const": "3 50"},
        "net.ipv4.vs.sync_version": {"type": "string", "const": "1"},
        "net.netfilter.nf_conntrack_acct": {"type": "string", "const": "0"},
        "net.netfilter.nf_conntrack_checksum": {"type": "string", "const": "0"},
        "net.netfilter.nf_conntrack_dccp_loose": {"type": "string", "const": "1"},
        "net.netfilter.nf_conntrack_dccp_timeout_closereq": {"type": "string", "const": "64"},
        "net.netfilter.nf_conntrack_dccp_timeout_closing": {"type": "string", "const": "64"},
        "net.netfilter.nf_conntrack_dccp_timeout_open": {"type": "string", "const": "43200"},
        "net.netfilter.nf_conntrack_dccp_timeout_partopen": {"type": "string", "const": "480"},
        "net.netfilter.nf_conntrack_dccp_timeout_request": {"type": "string", "const": "240"},
        "net.netfilter.nf_conntrack_dccp_timeout_respond": {"type": "string", "const": "480"},
        "net.netfilter.nf_conntrack_dccp_timeout_timewait": {"type": "string", "const": "240"},
        "net.netfilter.nf_conntrack_events": {"type": "string", "const": "1"},
        "net.netfilter.nf_conntrack_expect_max": {"type": "string", "const": "1024"},
        "net.netfilter.nf_conntrack_frag6_high_thresh": {"type": "string", "const": "4194304"},
        "net.netfilter.nf_conntrack_frag6_low_thresh": {"type": "string", "const": "3145728"},
        "net.netfilter.nf_conntrack_frag6_timeout": {"type": "string", "const": "60"},
        "net.netfilter.nf_conntrack_generic_timeout": {"type": "string", "const": "600"},
        "net.netfilter.nf_conntrack_gre_timeout": {"type": "string", "const": "30"},
        "net.netfilter.nf_conntrack_gre_timeout_stream": {"type": "string", "const": "180"},
        "net.netfilter.nf_conntrack_helper": {"type": "string", "const": "0"},
        "net.netfilter.nf_conntrack_icmp_timeout": {"type": "string", "const": "30"},
        "net.netfilter.nf_conntrack_icmpv6_timeout": {"type": "string", "const": "30"},
        "net.netfilter.nf_conntrack_log_invalid": {"type": "string", "const": "0"},
        "net.netfilter.nf_conntrack_max": {"type": "string", "const": "131072"},
        "net.netfilter.nf_conntrack_sctp_timeout_closed": {"type": "string", "const": "10"},
        "net.netfilter.nf_conntrack_sctp_timeout_cookie_echoed": {"type": "string", "const": "3"},
        "net.netfilter.nf_conntrack_sctp_timeout_cookie_wait": {"type": "string", "const": "3"},
        "net.netfilter.nf_conntrack_sctp_timeout_established": {"type": "string", "const": "432000"},
        "net.netfilter.nf_conntrack_sctp_timeout_heartbeat_acked": {"type": "string", "const": "210"},
        "net.netfilter.nf_conntrack_sctp_timeout_heartbeat_sent": {"type": "string", "const": "30"},
        "net.netfilter.nf_conntrack_sctp_timeout_shutdown_ack_sent": {"type": "string", "const": "3"},
        "net.netfilter.nf_conntrack_sctp_timeout_shutdown_recd": {"type": "string", "const": "0"},
        "net.netfilter.nf_conntrack_sctp_timeout_shutdown_sent": {"type": "string", "const": "0"},
        "net.netfilter.nf_conntrack_tcp_be_liberal": {"type": "string", "const": "0"},
        "net.netfilter.nf_conntrack_tcp_loose": {"type": "string", "const": "1"},
        "net.netfilter.nf_conntrack_tcp_max_retrans": {"type": "string", "const": "3"},
        "net.netfilter.nf_conntrack_tcp_timeout_close": {"type": "string", "const": "10"},
        "net.netfilter.nf_conntrack_tcp_timeout_close_wait": {"type": "string", "const": "3600"},
        "net.netfilter.nf_conntrack_tcp_timeout_fin_wait": {"type": "string", "const": "120"},
        "net.netfilter.nf_conntrack_tcp_timeout_last_ack": {"type": "string", "const": "30"},
        "net.netfilter.nf_conntrack_tcp_timeout_max_retrans": {"type": "string", "const": "300"},
        "net.netfilter.nf_conntrack_tcp_timeout_syn_recv": {"type": "string", "const": "60"},
        "net.netfilter.nf_conntrack_tcp_timeout_syn_sent": {"type": "string", "const": "120"},
        "net.netfilter.nf_conntrack_tcp_timeout_time_wait": {"type": "string", "const": "120"},
        "net.netfilter.nf_conntrack_tcp_timeout_unacknowledged": {"type": "string", "const": "30"},
        "net.netfilter.nf_conntrack_timestamp": {"type": "string", "const": "0"},
        "net.netfilter.nf_conntrack_udp_timeout": {"type": "string", "const": "30"},
        "net.netfilter.nf_conntrack_udp_timeout_stream": {"type": "string", "const": "120"},
        "net.nf_conntrack_max": {"type": "string", "const": "131072"},
        "vm.overcommit_memory": {"type": "string", "const": "1"},
        "vm.panic_on_oom": {"type": "string", "const": "0"}
      },
      "additionalProperties": { "type": "string" }
    },
    "state": { "type": "string", "pattern": "present|absent" }
  },
  "required": ["options"],
  "additionalProperties": false
}
